"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _isPlainObject2 = _interopRequireDefault(require("lodash/isPlainObject"));

var _reactBindings = require("@stardust-ui/react-bindings");

/**
 * Fela plugin for invoking keyframes with params. The keyframes, defined in the animationName prop,
 * are called with the params object, if defined in the animationName prop.
 *
 * Caution! Infinite recursion is possible in case if style object has links to self in the props
 * tree.
 */
var _default = function _default() {
  var invokeKeyframes = function invokeKeyframes(styles) {
    return Object.keys(styles).reduce(function (acc, cssPropertyName) {
      var cssPropertyValue = styles[cssPropertyName];

      if ((0, _isPlainObject2.default)(cssPropertyValue)) {
        if (cssPropertyName === 'animationName') {
          if (cssPropertyValue.keyframe) {
            styles[cssPropertyName] = (0, _reactBindings.callable)(cssPropertyValue.keyframe)(cssPropertyValue.params || {});
          }

          return Object.assign({}, acc, (0, _defineProperty2.default)({}, cssPropertyName, styles[cssPropertyName]));
        }

        return Object.assign({}, acc, (0, _defineProperty2.default)({}, cssPropertyName, invokeKeyframes(cssPropertyValue)));
      }

      return Object.assign({}, acc, (0, _defineProperty2.default)({}, cssPropertyName, styles[cssPropertyName]));
    }, {});
  };

  return invokeKeyframes;
};

exports.default = _default;